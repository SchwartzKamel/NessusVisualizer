{% extends 'layout.jinja2' %}

{% block title %}
  Scan Results
{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/severity-colors.js') }}"></script>
{% endblock %}

{% block content %}
<div class="container-flex">
  <h1>Scan Results</h1>
  {% for data in scan_data %}
    <div id="accordion-{{loop.index}}" role="tablist">
      <div class="card">
        <div class="card-header" role="tab" id="heading-{{loop.index}}" name="{{data['Risk']}}">
          <h5 class="mb-0">
            <a data-toggle="collapse" href="#collapse-{{loop.index}}" aria-expanded="true" aria-controls="collapse-{{loop.index}}">
              Plugin ID : {{data['Plugin ID']}} - {{data['Name']}} | Port: {{data['Port']}} | CVE: {{data['CVE']}} | CVSS: {{data['CVSS']}}
            </a>
          </h5>
        </div>
        <div id="collapse-{{loop.index}}" class="collapse" role="tabpanel" aria-labelledby="heading-{{loop.index}}" data-parent="#accordion-{{loop.index}}">
          <div class="card-body">
            <h5>TL;DR:</h5>
            <p>{{data['Synopsis']}}</p>
            <h5>Description:</h5>
            <p>{{data['Description']}}</p>
            <div id="accordion-{{loop.index}}-1" role="tablist">
              <div class="card">
                <div class="card-header" role="tab" id="heading-{{loop.index}}-1">
                  <h5>
                    <a data-toggle="collapse" href="#collapse-{{loop.index}}-1" aria-expanded="true" aria-controls="collapse-{{loop.index}}-1">
                      Output:
                    </a>
                  </h5>
                </div>
              </div>
            </div>
            <div id="collapse-{{loop.index}}-1" class="collapse" role="tabpanel" aria-labelledby="heading-{{loop.index}}-1" data-parent="#accordion-{{loop.index}}-1">
              <div class="card-body">
                <p>{{data['Plugin Output']}}</p>
              </div>
            </div>
            <p></p>
            <h5>Solution:</h5>
            <p>{{data['Solution']}}</P>
          </div>
        </div>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}